{
  "agent": {
    "id": "revenue_leak_detector",
    "name": "Revenue Leak Detector",
    "version": "1.0.0",
    "description": "Autonomous business health monitor that continuously scans the CRM pipeline, detects revenue leaks (ghosted prospects, stalled deals, overdue payments, churn risk), and sends structured alerts until a critical leak threshold triggers escalation."
  },
  "graph": {
    "id": "revenue-leak-detector-graph",
    "goal_id": "revenue-leak-detector",
    "version": "1.0.0",
    "entry_node": "monitor",
    "entry_points": {
      "start": "monitor"
    },
    "pause_nodes": [],
    "terminal_nodes": [],
    "conversation_mode": "continuous",
    "nodes": [
      {
        "id": "monitor",
        "name": "Monitor",
        "description": "Scan the CRM pipeline for the current cycle and collect raw signals.",
        "node_type": "event_loop",
        "max_node_visits": 0,
        "input_keys": ["cycle"],
        "output_keys": ["cycle", "deals_scanned", "overdue_invoices", "support_escalations"]
      },
      {
        "id": "analyze",
        "name": "Analyze",
        "description": "Detect revenue leak patterns in the current pipeline snapshot.",
        "node_type": "event_loop",
        "max_node_visits": 0,
        "input_keys": ["cycle", "deals_scanned", "overdue_invoices", "support_escalations"],
        "output_keys": ["cycle", "leak_count", "severity", "total_at_risk", "halt"]
      },
      {
        "id": "notify",
        "name": "Notify",
        "description": "Send a formatted revenue leak alert and pass halt state through.",
        "node_type": "event_loop",
        "max_node_visits": 0,
        "input_keys": ["cycle", "leak_count", "severity", "total_at_risk", "halt"],
        "output_keys": ["cycle", "halt"]
      },
      {
        "id": "followup",
        "name": "Followup",
        "description": "Send re-engagement emails to GHOSTED contacts and pass halt state through.",
        "node_type": "event_loop",
        "max_node_visits": 0,
        "input_keys": ["cycle", "halt"],
        "output_keys": ["cycle", "halt"]
      }
    ],
    "edges": [
      {
        "id": "monitor-to-analyze",
        "source": "monitor",
        "target": "analyze",
        "condition": "on_success"
      },
      {
        "id": "analyze-to-notify",
        "source": "analyze",
        "target": "notify",
        "condition": "on_success"
      },
      {
        "id": "notify-to-followup",
        "source": "notify",
        "target": "followup",
        "condition": "on_success"
      },
      {
        "id": "followup-to-monitor",
        "source": "followup",
        "target": "monitor",
        "condition": "conditional",
        "condition_expr": "str(halt).lower() != \"true\""
      }
    ]
  },
  "goal": {
    "id": "revenue-leak-detector",
    "name": "Revenue Leak Detector",
    "description": "Autonomous business health monitor that continuously scans the CRM pipeline, detects revenue leaks (ghosted prospects, stalled deals, overdue payments, churn risk), and sends structured alerts until a critical leak threshold triggers escalation.",
    "success_criteria": [
      {
        "id": "leak-detection",
        "description": "Detect all revenue leaks in the CRM pipeline each cycle",
        "metric": "output_contains",
        "target": "leak_count",
        "weight": 0.4
      },
      {
        "id": "alert-delivery",
        "description": "Successfully send alerts for every detected leak via console and Telegram",
        "metric": "output_contains",
        "target": "sent",
        "weight": 0.3
      },
      {
        "id": "followup-coverage",
        "description": "Send follow-up emails to all GHOSTED contacts",
        "metric": "output_contains",
        "target": "emails_sent",
        "weight": 0.3
      }
    ],
    "constraints": [
      {
        "id": "real-data-only",
        "description": "Only report leaks found in actual CRM data â€” never fabricate deals or contacts",
        "constraint_type": "hard",
        "category": "accuracy"
      },
      {
        "id": "single-tool-call",
        "description": "Each node calls its designated tool exactly once per cycle",
        "constraint_type": "hard",
        "category": "scope"
      },
      {
        "id": "halt-on-critical",
        "description": "Halt the monitoring loop when severity reaches critical or MAX_CYCLES of low severity elapse",
        "constraint_type": "hard",
        "category": "safety"
      },
      {
        "id": "graceful-offline",
        "description": "Operate fully offline when Telegram/Gmail/HubSpot credentials are not set",
        "constraint_type": "soft",
        "category": "quality"
      }
    ]
  },
  "required_tools": [
    "scan_pipeline",
    "detect_revenue_leaks",
    "send_revenue_alert",
    "send_followup_emails"
  ],
  "metadata": {
    "tags": ["revenue", "crm", "monitoring", "hubspot", "telegram", "gmail"],
    "category": "business"
  }
}
